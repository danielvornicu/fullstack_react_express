(this.webpackJsonpfullstack_react_express=this.webpackJsonpfullstack_react_express||[]).push([[0],{101:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n(0),c=n.n(r),s=n(10),i=n.n(s),o=(n(94),n(39),n(28)),l=n(12),u=n(11),j=n.n(u),d=n(20),b=n(17),h=n(132),x=n(67),p=n(146),f=n(137),m=n(80),O=n.n(m),g=n(66),v=function(e){e&&(console.log(e),localStorage.setItem("displayName",Object(g.a)(e).sub),localStorage.setItem("access_token",e))},y=function(){var e=localStorage.getItem("access_token");if(e){var t=Object(g.a)(e).aud;return t.includes("SHOW_USERS")&&t.includes("ADD_USER")}},k=function(e){var t="Bearer "+localStorage.getItem("access_token")||!1;return e?{"Content-type":e,Authorization:t}:{Authorization:t}},S=n(79),w=n.n(S),B=new Headers,_=function(){var e=Object(r.useState)(""),t=Object(b.a)(e,2),n=t[0],c=t[1],s=Object(r.useState)(""),i=Object(b.a)(s,2),o=i[0],u=i[1],m=Object(r.useState)(""),g=Object(b.a)(m,2),y=g[0],k=g[1],S=Object(l.f)(),_=function(){var e=Object(d.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B.set("Authorization","Basic "+w.a.encode(n+":"+o)),e.prev=1,e.next=4,fetch("http://localhost:5000/api/users/login",{headers:B,method:"POST"});case 4:return t=e.sent,e.next=7,t.json();case 7:(a=e.sent).message?k(a.message):(v(a.access_token),S.push("/posts")),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log("Error logging into app ",e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)(h.a,{container:!0,direction:"column",alignItems:"center",style:{marginTop:"10vh"},children:[Object(a.jsx)(h.a,{item:!0,style:{marginBottom:"10vh"},children:Object(a.jsxs)(x.a,{variant:"h3",color:"primary",children:["Welcome to PostIt!",Object(a.jsx)(O.a,{fontSize:"large",color:"primary"})]})}),Object(a.jsx)(h.a,{item:!0,style:{marginBottom:"2vh"},children:Object(a.jsx)(p.a,{variant:"outlined",id:"username-input",label:"username",value:n,onChange:function(e){return t=e.target.value,c(t);var t}})}),Object(a.jsx)(h.a,{item:!0,style:{marginBottom:"2vh"},children:Object(a.jsx)(p.a,{variant:"outlined",id:"password-input",label:"password",type:"password",value:o,onChange:function(e){return function(e){return u(e)}(e.target.value)}})}),Object(a.jsx)(h.a,{item:!0,style:{marginBottom:"5vh"},children:Object(a.jsx)(f.a,{"aria-label":"login",variant:"contained",size:"medium",color:"primary",onClick:_,children:"Login"})}),Object(a.jsx)(h.a,{item:!0,children:Object(a.jsx)(x.a,{variant:"body2",color:"error",children:y})})]})},A=n(62),C=n(142),N=n(143),E=n(149),I=n(144),P=n(145),U=n(141),z=n(63),L=n.n(z),D=n(64),R=n.n(D),T=n(138),V=n(139),F=n(147),H=n(140),J=n(82),M=n(148),W=n(81),G=n.n(W),Y=function(e){var t=e.tabValue,n=["/posts","/posts/new","/users","/users/new"],r=c.a.useState(null),s=Object(b.a)(r,2),i=s[0],o=s[1],u=Boolean(i),j=Object(l.f)(),d=function(){var e=localStorage.getItem("access_token");if(e){var t=Object(g.a)(e).aud;return!t.includes("SHOW_USERS")&&!t.includes("ADD_USER")}}();return Object(a.jsx)("div",{style:{flexGrow:1},children:Object(a.jsx)(T.a,{position:"fixed",children:Object(a.jsxs)(V.a,{children:[Object(a.jsxs)(F.a,{value:t,onChange:function(e,t){return j.push(n[t])},children:[Object(a.jsx)(H.a,{label:"Posts"}),Object(a.jsx)(H.a,{label:"Add post"}),Object(a.jsx)(H.a,{label:"Users",disabled:d}),Object(a.jsx)(H.a,{label:"Add User",disabled:d})]}),Object(a.jsx)("div",{style:{flexGrow:1}}),Object(a.jsx)(U.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){return o(e.currentTarget)},color:"inherit",children:Object(a.jsx)(G.a,{})}),Object(a.jsxs)(J.a,{id:"menu-appbar",anchorEl:i,open:u,onClose:function(){o(null)},children:[Object(a.jsx)(M.a,{children:localStorage.getItem("displayName")}),Object(a.jsx)(M.a,{onClick:function(){fetch("http://localhost:5000/api/users/logout",{headers:k()}).then((function(e){localStorage.clear(),j.push("/login")}))},children:"Logout"})]})]})})})},q=n(35),K=q.API_BASE_URL+"/users",Q=function(){var e=Object(r.useState)([]),t=Object(b.a)(e,2),n=t[0],c=t[1],s=Object(l.f)(),i=y(),o=function(){var e=Object(d.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(K,{headers:k()});case 3:if(401!==(t=e.sent).status){e.next=8;break}localStorage.clear(),s.push("/login"),e.next=11;break;case 8:return e.next=10,t.json();case 10:n=e.sent;case 11:n&&(v(n.access_token),c(Object(A.a)(n.users))),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log("Error fetching users ",e.t0.message);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){o()}),[]),Object(a.jsxs)("div",{className:"Content",children:[Object(a.jsx)(Y,{tabValue:2}),!i&&Object(a.jsx)(h.a,{container:!0,justify:"center",direction:"column",alignItems:"center",children:Object(a.jsx)(h.a,{item:!0,style:{marginBottom:"5vh"},children:Object(a.jsx)(x.a,{variant:"h6",gutterBottom:!0,children:"Admin area only"})})}),i&&Object(a.jsxs)(h.a,{container:!0,justify:"center",direction:"column",alignItems:"center",children:[Object(a.jsx)(h.a,{item:!0,style:{marginBottom:"5vh"},children:Object(a.jsx)(x.a,{variant:"h3",gutterBottom:!0,children:"Users List"})}),Object(a.jsx)(h.a,{item:!0,container:!0,justify:"center",xs:12,children:n&&n.map((function(e,t){return Object(a.jsx)(X,{id:e._id,userName:e.username,firstName:e.firstName,lastName:e.lastName,role:e.role},t)}))})]})]})},X=function(e){var t=e.id,n=e.firstName,r=e.lastName,c=e.userName,s=e.role,i=Object(l.f)(),o=function(){localStorage.clear(),i.push("/login")},u=function(){window.location.reload(!1)};function b(){return(b=Object(d.a)(j.a.mark((function e(t){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=K+"/"+t+"/delete",e.next=4,fetch(n,{headers:k()});case 4:if(401!==(a=e.sent).status){e.next=9;break}o(),e.next=12;break;case 9:return e.next=11,a.json();case 11:r=e.sent;case 12:r&&(v(r.access_token),u()),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log("Error deleting user ",e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}return Object(a.jsxs)(C.a,{elevation:3,className:"User",children:[Object(a.jsx)(N.a,{avatar:Object(a.jsx)(E.a,{"aria-label":"User Avatar",children:c.charAt(0)}),title:Object(a.jsx)(x.a,{variant:"body2",gutterBottom:!0,children:c+" ("+s+") "})}),Object(a.jsx)(I.a,{children:Object(a.jsx)(x.a,{variant:"h6",gutterBottom:!0,color:"primary",children:n+" "+r})}),Object(a.jsxs)(P.a,{disableSpacing:!0,style:{width:"100%",justifyContent:"flex-end"},children:[Object(a.jsx)(U.a,{"aria-label":"Edit Post",onClick:function(){i.push("/users/"+t+"/edit")},color:"primary",children:Object(a.jsx)(L.a,{fontSize:"small"})}),Object(a.jsx)(U.a,{"aria-label":"Delete Post",onClick:function(){!function(e){b.apply(this,arguments)}(t)},color:"secondary",edge:"end",children:Object(a.jsx)(R.a,{fontSize:"small"})})]})]})},Z=n(150),$=q.API_BASE_URL+"/users",ee=function(){var e=Object(r.useState)(""),t=Object(b.a)(e,2),n=t[0],c=t[1],s=Object(r.useState)(""),i=Object(b.a)(s,2),o=i[0],u=i[1],m=Object(r.useState)(""),O=Object(b.a)(m,2),g=O[0],S=O[1],w=Object(r.useState)(""),B=Object(b.a)(w,2),_=B[0],A=B[1],C=Object(r.useState)(!1),N=Object(b.a)(C,2),E=N[0],I=N[1],P=Object(l.f)(),U=Object(l.g)().id,z=y(),L=function(){localStorage.clear(),P.push("/login")};Object(r.useEffect)((function(){D(U)}),[]);var D=function(){var e=Object(d.a)(j.a.mark((function e(t){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n="undefined"===typeof t?$+"/new":$+"/"+t,e.next=4,fetch(n,{headers:k()});case 4:if(401!==(a=e.sent).status){e.next=9;break}L(),e.next=12;break;case 9:return e.next=11,a.json();case 11:r=e.sent;case 12:r&&(v(r.refresh_token),c(r.user.username),u(r.user.password),S(r.user.firstName),A(r.user.lastName)),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log("Error getting user ",e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(d.a)(j.a.mark((function e(){var t,a,r,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={_id:U,username:n,password:o||"",firstName:g,lastName:_,role:E?"admin":"user"},t="undefined"===typeof U?$+"/new":$+"/"+a._id+"/edit",e.next=5,fetch(t,{headers:k("application/json"),method:"POST",body:JSON.stringify(a)});case 5:return 401===(r=e.sent).status?L():200===r.status&&(c(""),u(""),S(""),A("")),e.next=9,r.json();case 9:(s=e.sent)&&(v(s.access_token||""),P.push("/users")),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log("Error saving user ",e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:"AddUser",children:[Object(a.jsx)(Y,{tabValue:3}),!z&&Object(a.jsx)(h.a,{container:!0,justify:"center",direction:"column",alignItems:"center",children:Object(a.jsx)(h.a,{item:!0,style:{marginBottom:"5vh"},children:Object(a.jsx)(x.a,{variant:"h6",gutterBottom:!0,children:"Admin area only"})})}),z&&Object(a.jsxs)(h.a,{container:!0,direction:"column",alignItems:"center",children:[Object(a.jsx)(h.a,{item:!0,style:{marginBottom:"5vh"},children:Object(a.jsx)(x.a,{variant:"h3",gutterBottom:!0,children:"undefined"===typeof U?"Add New User":"Edit User "})}),Object(a.jsx)(h.a,{item:!0,style:{marginBottom:"5vh"},children:Object(a.jsx)(p.a,{id:"username-input",variant:"outlined",label:"username",value:n,onChange:function(e){return function(e){return c(e)}(e.target.value)}})}),Object(a.jsx)(h.a,{item:!0,style:{marginBottom:"5vh"},children:Object(a.jsx)(p.a,{id:"password-input",variant:"outlined",label:"password",value:o,onChange:function(e){return function(e){return u(e)}(e.target.value)}})}),Object(a.jsx)(h.a,{item:!0,style:{marginBottom:"5vh"},children:Object(a.jsx)(p.a,{id:"firstName-input",variant:"outlined",label:"First Name",value:g,onChange:function(e){return function(e){return S(e)}(e.target.value)}})}),Object(a.jsx)(h.a,{item:!0,style:{marginBottom:"5vh"},children:Object(a.jsx)(p.a,{id:"lastName-input",variant:"outlined",label:"Last Name",value:_,onChange:function(e){return function(e){return A(e)}(e.target.value)}})}),Object(a.jsx)(h.a,{item:!0,style:{marginBottom:"5vh"},children:Object(a.jsxs)(x.a,{variant:"body2",gutterBottom:!0,children:["Admin profile:",Object(a.jsx)(Z.a,{checked:E,color:"primary",name:"isAdmin",inputProps:{"aria-label":"primary checkbox"},onChange:function(){I((function(e){return!e}))}})]})}),Object(a.jsxs)(h.a,{item:!0,container:!0,direction:"row",spacing:1,alignItems:"center",justify:"center",style:{marginBottom:"7vh"},children:[Object(a.jsx)(h.a,{item:!0,children:Object(a.jsx)(f.a,{"aria-label":"login",variant:"contained",size:"large",color:"primary",onClick:function(){R()},children:"Validate"})}),Object(a.jsx)(h.a,{item:!0,children:Object(a.jsx)(f.a,{"aria-label":"login",variant:"contained",size:"large",color:"secondary",onClick:function(){P.push("/users")},children:"Cancel"})})]})]})]})},te=n(48),ne=q.API_BASE_URL+"/posts",ae=function(){var e=Object(r.useState)([]),t=Object(b.a)(e,2),n=t[0],c=t[1],s=Object(l.f)(),i=function(){var e=Object(d.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(ne,{headers:k()});case 3:if(401!==(t=e.sent).status){e.next=8;break}localStorage.clear(),s.push("/login"),e.next=11;break;case 8:return e.next=10,t.json();case 10:n=e.sent;case 11:n&&(v(n.access_token),c(Object(A.a)(n.posts))),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log("Error fetching posts ",e.t0.message);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}();function o(e){var t=new Date(e),n=t.getMonth()+1,a=t.getDate(),r=t.getHours(),c=t.getMinutes(),s=n>=10?n:"0".concat(n),i=a>=10?a:"0".concat(a),o=r>=10?r:"0".concat(r),l=c>=10?c:"0".concat(c);return"".concat(i,"/").concat(s,"/").concat(t.getFullYear()," at ").concat(o,"h").concat(l)}return Object(r.useEffect)((function(){i()}),[]),Object(a.jsxs)("div",{className:"Content",children:[Object(a.jsx)(Y,{tabValue:0}),Object(a.jsxs)(h.a,{container:!0,justify:"center",alignItems:"center",direction:"column",children:[Object(a.jsx)(h.a,{item:!0,style:{marginBottom:"5vh"},children:Object(a.jsx)(x.a,{variant:"h3",gutterBottom:!0,children:"Posts List"})}),Object(a.jsx)(h.a,{item:!0,container:!0,justify:"center",children:n&&n.map((function(e,t){return Object(a.jsx)(re,{id:e._id,text:e.text,createdAt:o(e.createdAt),user_id:e.user_id},t)}))})]})]})},re=function(e){var t,n=e.id,r=e.text,c=e.createdAt,s=(e.user_id,Object(l.f)()),i=function(){window.location.reload(!1)};function o(){return(o=Object(d.a)(j.a.mark((function e(t){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=ne+"/"+t+"/delete",e.next=4,fetch(n,{headers:k()});case 4:return a=e.sent,e.next=7,a.json();case 7:(r=e.sent)&&(v(r.access_token),i()),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log("Error deleting post ",e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}return Object(a.jsxs)(C.a,{elevation:3,className:"Post",children:[Object(a.jsxs)(I.a,{children:[Object(a.jsx)(x.a,(t={gutterBottom:!0,variant:"h6"},Object(te.a)(t,"gutterBottom",!0),Object(te.a)(t,"color","primary"),Object(te.a)(t,"component","h2"),Object(te.a)(t,"children",r),t)),Object(a.jsx)(x.a,{variant:"body2",color:"textSecondary",component:"p",children:c})]}),Object(a.jsxs)(P.a,{disableSpacing:!0,style:{width:"100%",justifyContent:"flex-end"},children:[Object(a.jsx)(U.a,{"aria-label":"Edit Post",onClick:function(){s.push("/posts/"+n+"/edit")},color:"primary",children:Object(a.jsx)(L.a,{fontSize:"small"})}),Object(a.jsx)(U.a,{"aria-label":"Delete Post",onClick:function(){!function(e){o.apply(this,arguments)}(n)},color:"secondary",edge:"end",children:Object(a.jsx)(R.a,{fontSize:"small"})})]})]})},ce=n(136),se=q.API_BASE_URL+"/posts",ie=function(){var e=Object(r.useState)(""),t=Object(b.a)(e,2),n=t[0],c=t[1],s=Object(l.f)(),i=Object(l.g)().id;Object(r.useEffect)((function(){o(i)}),[]);var o=function(){var e=Object(d.a)(j.a.mark((function e(t){var n,a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n="undefined"===typeof t?se+"/new":se+"/"+t,e.next=4,fetch(n,{headers:k()});case 4:if(401!==(a=e.sent).status){e.next=9;break}localStorage.clear(),s.push("/login"),e.next=12;break;case 9:return e.next=11,a.json();case 11:r=e.sent;case 12:r&&(v(r.refresh_token),c(r.post.text)),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log("Error getting post ",e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(d.a)(j.a.mark((function e(){var t,a,r,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={_id:i,text:n},t="undefined"===typeof i?se+"/new":se+"/"+i+"/edit",e.next=5,fetch(t,{headers:k("application/json"),method:"POST",body:JSON.stringify(a)});case 5:return 200===(r=e.sent).status&&c(""),e.next=9,r.json();case 9:(o=e.sent)&&(v(o.access_token||""),s.push("/posts")),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log("Error saving post ",e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:"AddPost",children:[Object(a.jsx)(Y,{tabValue:1}),Object(a.jsxs)(h.a,{container:!0,direction:"column",alignItems:"center",children:[Object(a.jsx)(h.a,{item:!0,style:{marginBottom:"5vh"},children:Object(a.jsx)(x.a,{variant:"h3",gutterBottom:!0,children:"undefined"===typeof i?"Add New Post":"Edit Post "})}),Object(a.jsx)(h.a,{item:!0,style:{marginBottom:"5vh"},children:Object(a.jsx)(ce.a,{style:{width:200,height:100},height:"10em",placeholder:"Add text",id:"text-input",variant:"outlined",label:"Post",value:n,onChange:function(e){return function(e){return c(e)}(e.target.value)}})}),Object(a.jsxs)(h.a,{item:!0,container:!0,direction:"row",spacing:1,alignItems:"center",justify:"center",style:{marginBottom:"7vh"},children:[Object(a.jsx)(h.a,{item:!0,children:Object(a.jsx)(f.a,{"aria-label":"login",variant:"contained",size:"large",color:"primary",onClick:function(){u()},children:"Validate"})}),Object(a.jsx)(h.a,{item:!0,children:Object(a.jsx)(f.a,{"aria-label":"login",variant:"contained",size:"large",color:"secondary",onClick:function(){s.push("/posts")},children:"Cancel"})})]})]})]})};function oe(){return Object(a.jsx)("div",{className:"App",children:Object(a.jsx)(o.a,{children:Object(a.jsxs)(l.c,{children:[Object(a.jsx)(l.a,{exact:!0,path:"/",children:Object(a.jsx)(_,{})}),Object(a.jsx)(l.a,{exact:!0,path:"/login",children:Object(a.jsx)(_,{})}),Object(a.jsx)(l.a,{exact:!0,path:"/users",children:Object(a.jsx)(Q,{})}),Object(a.jsx)(l.a,{exact:!0,path:"/users/new",children:Object(a.jsx)(ee,{})}),Object(a.jsx)(l.a,{exact:!0,path:"/users/:id/edit",children:Object(a.jsx)(ee,{})}),Object(a.jsx)(l.a,{exact:!0,path:"/posts",children:Object(a.jsx)(ae,{})}),Object(a.jsx)(l.a,{exact:!0,path:"/posts/new",children:Object(a.jsx)(ie,{})}),Object(a.jsx)(l.a,{exact:!0,path:"/posts/:id/edit",children:Object(a.jsx)(ie,{})})]})})})}var le=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,151)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};i.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(oe,{})}),document.getElementById("root")),le()},35:function(e,t){e.exports.API_BASE_URL="https://fullstack-express-react.herokuapp.com/api"},39:function(e,t,n){},94:function(e,t,n){}},[[101,1,2]]]);
//# sourceMappingURL=main.b3ac323d.chunk.js.map